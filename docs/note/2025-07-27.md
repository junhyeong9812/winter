# íŒŒì¼ ì—…ë¡œë“œ í•µì‹¬ í´ë˜ìŠ¤ ìƒì„¸ ë¶„ì„

## ğŸ“‹ ê°œìš”

Winter Framework 24ì±•í„°ì—ì„œ êµ¬í˜„í•˜ëŠ” íŒŒì¼ ì—…ë¡œë“œ ê¸°ëŠ¥ì˜ í•µì‹¬ í´ë˜ìŠ¤ë“¤ì„ í•œ ì¤„ì”© ìƒì„¸íˆ ë¶„ì„í•©ë‹ˆë‹¤.

---

## 1. HttpRequest.java - HTTP ìš”ì²­ ì²˜ë¦¬ í´ë˜ìŠ¤

### êµ¬ì¡° ë° ëª©ì 
Multipart ìš”ì²­ ì§€ì›ì„ ìœ„í•´ ê¸°ì¡´ HttpRequestë¥¼ í™•ì¥í•œ í´ë˜ìŠ¤ì…ë‹ˆë‹¤.

```java
package winter.http;

import java.io.BufferedReader;        // í…ìŠ¤íŠ¸ ìŠ¤íŠ¸ë¦¼ ì½ê¸°ìš©
import java.io.StringReader;          // ë¬¸ìì—´ì„ Readerë¡œ ë³€í™˜
import java.util.*;                   // ì»¬ë ‰ì…˜ í”„ë ˆì„ì›Œí¬

/**
 * HTTP ìš”ì²­ ì •ë³´ë¥¼ í‘œí˜„í•˜ëŠ” í´ë˜ìŠ¤
 * 
 * ê²½ë¡œ, ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°, HTTP ë©”ì„œë“œ, í—¤ë”, ìš”ì²­ ë³¸ë¬¸ì„ í¬í•¨í•©ë‹ˆë‹¤.
 * Multipart ìš”ì²­ ì²˜ë¦¬ë¥¼ ìœ„í•´ ê¸°ì¡´ êµ¬ì¡°ë¥¼ í™•ì¥í–ˆìŠµë‹ˆë‹¤.
 * 
 * ì£¼ìš” ë³€ê²½ì‚¬í•­:
 * 1. parametersë¥¼ Map<String, List<String>>ìœ¼ë¡œ ë³€ê²½ (ë‹¤ì¤‘ê°’ ì§€ì›)
 * 2. ìš”ì²­ ë³¸ë¬¸ ì²˜ë¦¬ë¥¼ ìœ„í•œ BufferedReader ì¶”ê°€
 * 3. ìƒˆë¡œìš´ ìƒì„±ìì™€ ë©”ì„œë“œ ì¶”ê°€
 */
public class HttpRequest {
    // === í•µì‹¬ í•„ë“œë“¤ ===
    private final String path;                              // ìš”ì²­ ê²½ë¡œ ("/upload", "/api/users")
    private final String method;                            // HTTP ë©”ì„œë“œ ("GET", "POST", "PUT" ë“±)
    private final Map<String, List<String>> parameters;    // ì¿¼ë¦¬/í¼ íŒŒë¼ë¯¸í„° (ë‹¤ì¤‘ê°’ ì§€ì›)
    private final Map<String, String> headers;             // HTTP í—¤ë”ë“¤ (ì†Œë¬¸ì í‚¤ë¡œ ì •ê·œí™”)
    private final BufferedReader body;                     // ìš”ì²­ ë³¸ë¬¸ ìŠ¤íŠ¸ë¦¼ (POST ë°ì´í„°, Multipart ë“±)

    /**
     * ê¸°ë³¸ ìƒì„±ì (GET ìš”ì²­ ì „ìš©)
     * "/users?page=1&size=10" ê°™ì€ ë‹¨ìˆœí•œ GET ìš”ì²­ì— ì‚¬ìš©
     */
    public HttpRequest(String rawPath) {
        this(rawPath, "GET");                               // ê¸°ë³¸ê°’ìœ¼ë¡œ GET ë©”ì„œë“œ ì„¤ì •
    }

    /**
     * ìƒì„±ì - ìš”ì²­ ê²½ë¡œ ë° HTTP ë©”ì„œë“œë¥¼ ì§€ì •
     * ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ëŠ” ìë™ìœ¼ë¡œ íŒŒì‹±ë©ë‹ˆë‹¤.
     *
     * @param rawPath "/register?name=jun&tags=java&tags=spring" (ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° í¬í•¨ ê°€ëŠ¥)
     * @param method "GET", "POST", "PUT", "DELETE" ë“±
     */
    public HttpRequest(String rawPath, String method) {
        this(rawPath, method, new HashMap<>(), new HashMap<>(), null);  // ì™„ì „í•œ ìƒì„±ì í˜¸ì¶œ
    }

    /**
     * ì™„ì „í•œ ìƒì„±ì - ëª¨ë“  ìš”ì²­ ì •ë³´ë¥¼ ì§€ì •
     * Multipart ìš”ì²­ì´ë‚˜ ë³µì¡í•œ POST ìš”ì²­ì—ì„œ ì‚¬ìš©
     * 
     * @param rawPath ìš”ì²­ ê²½ë¡œ (ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° í¬í•¨ ê°€ëŠ¥)
     * @param method HTTP ë©”ì„œë“œ
     * @param headers HTTP í—¤ë” ë§µ (Content-Type, Authorization ë“±)
     * @param parameters íŒŒë¼ë¯¸í„° ë§µ (í¼ ë°ì´í„°, Multipart íŒŒë¼ë¯¸í„°)
     * @param body ìš”ì²­ ë³¸ë¬¸ BufferedReader (POST/PUT ë°ì´í„°)
     */
    public HttpRequest(String rawPath, String method, Map<String, String> headers, 
                      Map<String, List<String>> parameters, BufferedReader body) {
        // ë©”ì„œë“œ ì •ê·œí™” (ëŒ€ë¬¸ìë¡œ ë³€í™˜, null ì²´í¬)
        this.method = method != null ? method.toUpperCase() : "GET";
        
        // ë³¸ë¬¸ ìŠ¤íŠ¸ë¦¼ ì´ˆê¸°í™” (nullì´ë©´ ë¹ˆ ìŠ¤íŠ¸ë¦¼ìœ¼ë¡œ ì´ˆê¸°í™”)
        this.body = body != null ? body : new BufferedReader(new StringReader(""));
        
        // í—¤ë” ë§µ ì´ˆê¸°í™” ë° ë³µì‚¬ (í‚¤ë¥¼ ì†Œë¬¸ìë¡œ ì •ê·œí™”)
        this.headers = new HashMap<>();
        if (headers != null) {
            for (Map.Entry<String, String> entry : headers.entrySet()) {
                this.headers.put(entry.getKey().toLowerCase(), entry.getValue());  // ëŒ€ì†Œë¬¸ì ë¬´ê´€í•˜ê²Œ ì²˜ë¦¬
            }
        }
        
        // íŒŒë¼ë¯¸í„° ë§µ ì´ˆê¸°í™” ë° ê¹Šì€ ë³µì‚¬ (ë°©ì–´ì  ë³µì‚¬)
        this.parameters = new HashMap<>();
        if (parameters != null) {
            for (Map.Entry<String, List<String>> entry : parameters.entrySet()) {
                this.parameters.put(entry.getKey(), new ArrayList<>(entry.getValue()));  // ë¦¬ìŠ¤íŠ¸ë„ ë³µì‚¬
            }
        }
        
        // ê²½ë¡œì—ì„œ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° íŒŒì‹±
        String[] parts = rawPath.split("\\?", 2);           // "?"ë¡œ ê²½ë¡œì™€ ì¿¼ë¦¬ ë¶„ë¦¬ (ìµœëŒ€ 2ê°œë¡œ ë¶„í• )
        this.path = parts[0];                               // ìˆœìˆ˜ ê²½ë¡œ ë¶€ë¶„

        if (parts.length > 1) {                             // ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ê°€ ìˆìœ¼ë©´
            parseQueryString(parts[1]);                     // ì¿¼ë¦¬ ë¬¸ìì—´ íŒŒì‹±
        }
    }

    /**
     * ì¿¼ë¦¬ ë¬¸ìì—´ì„ íŒŒì‹±í•˜ì—¬ íŒŒë¼ë¯¸í„° ë§µì— ì¶”ê°€
     * "name=john&age=25&tags=java&tags=spring" í˜•íƒœì˜ ë¬¸ìì—´ ì²˜ë¦¬
     */
    private void parseQueryString(String queryString) {
        if (queryString == null || queryString.trim().isEmpty()) {
            return;                                         // ë¹ˆ ì¿¼ë¦¬ ë¬¸ìì—´ì€ ë¬´ì‹œ
        }
        
        String[] pairs = queryString.split("&");           // "&"ë¡œ ê° íŒŒë¼ë¯¸í„° ë¶„ë¦¬
        for (String pair : pairs) {
            String[] kv = pair.split("=", 2);              // "="ë¡œ í‚¤-ê°’ ë¶„ë¦¬ (ìµœëŒ€ 2ê°œ)
            if (kv.length >= 1) {                           // í‚¤ê°€ ìˆìœ¼ë©´ (ê°’ì´ ì—†ì–´ë„ ë¨)
                String key = urlDecode(kv[0]);              // URL ë””ì½”ë”© ì ìš©
                String value = kv.length == 2 ? urlDecode(kv[1]) : "";  // ê°’ì´ ì—†ìœ¼ë©´ ë¹ˆ ë¬¸ìì—´
                addParameter(key, value);                   // íŒŒë¼ë¯¸í„° ë§µì— ì¶”ê°€
            }
        }
    }
    
    /**
     * ê°„ë‹¨í•œ URL ë””ì½”ë”© (+ â†’ ê³µë°±, %20 â†’ ê³µë°± ë“±)
     * ì‹¤ì œë¡œëŠ” ë” ë³µì¡í•œ ë””ì½”ë”©ì´ í•„ìš”í•˜ì§€ë§Œ ì—¬ê¸°ì„œëŠ” ê¸°ë³¸ë§Œ ì²˜ë¦¬
     */
    private String urlDecode(String value) {
        if (value == null) return "";
        return value.replace("+", " ")                      // "+" ë¬¸ìë¥¼ ê³µë°±ìœ¼ë¡œ
                   .replace("%20", " ");                    // "%20"ì„ ê³µë°±ìœ¼ë¡œ
    }

    // === Getter ë©”ì„œë“œë“¤ ===
    
    /**
     * ìˆœìˆ˜ ìš”ì²­ ê²½ë¡œ ë°˜í™˜ (ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° ì œì™¸)
     * ì˜ˆ: "/register?name=jun" â†’ "/register"
     */
    public String getPath() {
        return path;
    }

    /**
     * HTTP ë©”ì„œë“œ ë°˜í™˜ (ëŒ€ë¬¸ìë¡œ ì •ê·œí™”ë¨)
     * ì˜ˆ: "get" â†’ "GET", "post" â†’ "POST"
     */
    public String getMethod() {
        return method;
    }

    /**
     * ìš”ì²­ ë³¸ë¬¸ BufferedReader ë°˜í™˜
     * POST/PUT ìš”ì²­ì˜ ë°ì´í„°ë‚˜ Multipart ë°ì´í„° ì½ê¸°ìš©
     */
    public BufferedReader getBody() {
        return body;
    }

    // === íŒŒë¼ë¯¸í„° ê´€ë ¨ ë©”ì„œë“œë“¤ ===

    /**
     * ê°œë³„ íŒŒë¼ë¯¸í„°ì˜ ì²« ë²ˆì§¸ ê°’ ì¡°íšŒ
     * ê°€ì¥ ìì£¼ ì‚¬ìš©ë˜ëŠ” ë©”ì„œë“œ (ë‹¨ì¼ê°’ íŒŒë¼ë¯¸í„°ìš©)
     * 
     * @param key íŒŒë¼ë¯¸í„° ì´ë¦„ ("name", "email" ë“±)
     * @return ì²« ë²ˆì§¸ ê°’, ì—†ìœ¼ë©´ null
     */
    public String getParameter(String key) {
        List<String> values = parameters.get(key);         // í•´ë‹¹ í‚¤ì˜ ê°’ ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ
        return (values != null && !values.isEmpty()) ? values.get(0) : null;  // ì²« ë²ˆì§¸ ê°’ ë°˜í™˜
    }

    /**
     * ê°œë³„ íŒŒë¼ë¯¸í„°ì˜ ëª¨ë“  ê°’ ì¡°íšŒ
     * ë‹¤ì¤‘ ì„ íƒ ì²´í¬ë°•ìŠ¤ë‚˜ multiple íŒŒì¼ ì—…ë¡œë“œì—ì„œ ì‚¬ìš©
     * 
     * @param key íŒŒë¼ë¯¸í„° ì´ë¦„
     * @return ê°’ ëª©ë¡ (ë°©ì–´ì  ë³µì‚¬ë³¸), ì—†ìœ¼ë©´ ë¹ˆ ë¦¬ìŠ¤íŠ¸
     */
    public List<String> getParameterValues(String key) {
        return new ArrayList<>(parameters.getOrDefault(key, Collections.emptyList()));  // ë°©ì–´ì  ë³µì‚¬
    }

    /**
     * ì „ì²´ íŒŒë¼ë¯¸í„° Map ë°˜í™˜ (í•˜ìœ„ í˜¸í™˜ì„±ì„ ìœ„í•´ ì²« ë²ˆì§¸ ê°’ë§Œ)
     * 
     * @deprecated getParameterMap() ì‚¬ìš© ê¶Œì¥
     * @return íŒŒë¼ë¯¸í„°ëª… -> ì²« ë²ˆì§¸ ê°’ ë§µ
     */
    @Deprecated                                             // ë” ì´ìƒ ê¶Œì¥í•˜ì§€ ì•ŠìŒì„ í‘œì‹œ
    public Map<String, String> getParameters() {
        Map<String, String> result = new HashMap<>();
        for (Map.Entry<String, List<String>> entry : parameters.entrySet()) {
            List<String> values = entry.getValue();
            if (!values.isEmpty()) {
                result.put(entry.getKey(), values.get(0)); // ì²« ë²ˆì§¸ ê°’ë§Œ ì‚¬ìš© (í•˜ìœ„ í˜¸í™˜ì„±)
            }
        }
        return result;
    }
    
    /**
     * ì „ì²´ íŒŒë¼ë¯¸í„° Map ë°˜í™˜ (ë‹¤ì¤‘ê°’ ì§€ì›)
     * ìƒˆë¡œìš´ ì½”ë“œì—ì„œëŠ” ì´ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.
     */
    public Map<String, List<String>> getParameterMap() {
        Map<String, List<String>> result = new HashMap<>();
        for (Map.Entry<String, List<String>> entry : parameters.entrySet()) {
            result.put(entry.getKey(), new ArrayList<>(entry.getValue()));  // ë°©ì–´ì  ë³µì‚¬
        }
        return result;
    }

    /**
     * íŒŒë¼ë¯¸í„° ì¶”ê°€ (ê¸°ì¡´ ê°’ì— ì¶”ê°€)
     * ê°™ì€ í‚¤ì— ì—¬ëŸ¬ ê°’ì„ ì¶”ê°€í•  ë•Œ ì‚¬ìš©
     */
    public void addParameter(String key, String value) {
        parameters.computeIfAbsent(key, k -> new ArrayList<>()).add(value);  // í‚¤ê°€ ì—†ìœ¼ë©´ ë¦¬ìŠ¤íŠ¸ ìƒì„± í›„ ì¶”ê°€
    }
    
    /**
     * íŒŒë¼ë¯¸í„° ì„¤ì • (ê¸°ì¡´ ê°’ ë®ì–´ì“°ê¸°)
     * ë‹¨ì¼ê°’ìœ¼ë¡œ íŒŒë¼ë¯¸í„°ë¥¼ ì„¤ì •í•  ë•Œ ì‚¬ìš©
     */
    public void setParameter(String key, String value) {
        List<String> values = new ArrayList<>();
        values.add(value);
        parameters.put(key, values);                        // ê¸°ì¡´ ê°’ë“¤ì„ ëª¨ë‘ êµì²´
    }
    
    /**
     * íŒŒë¼ë¯¸í„° ì„¤ì • (ë‹¤ì¤‘ê°’)
     * ì—¬ëŸ¬ ê°’ì„ í•œ ë²ˆì— ì„¤ì •í•  ë•Œ ì‚¬ìš©
     */
    public void setParameterValues(String key, List<String> values) {
        parameters.put(key, new ArrayList<>(values));       // ë°©ì–´ì  ë³µì‚¬ë¡œ ì €ì¥
    }

    /**
     * íŒŒë¼ë¯¸í„° ì¡´ì¬ ì—¬ë¶€ í™•ì¸
     * ê°’ì´ ìˆëŠ”ì§€ ê²€ì‚¬ (ë¹ˆ ë¦¬ìŠ¤íŠ¸ëŠ” ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²ƒìœ¼ë¡œ ê°„ì£¼)
     */
    public boolean hasParameter(String key) {
        return parameters.containsKey(key) && !parameters.get(key).isEmpty();
    }
    
    /**
     * ëª¨ë“  íŒŒë¼ë¯¸í„° ì´ë¦„ ë°˜í™˜
     * ì–´ë–¤ íŒŒë¼ë¯¸í„°ë“¤ì´ ìˆëŠ”ì§€ í™•ì¸í•  ë•Œ ì‚¬ìš©
     */
    public Set<String> getParameterNames() {
        return new HashSet<>(parameters.keySet());          // ë°©ì–´ì  ë³µì‚¬
    }

    // === í—¤ë” ê´€ë ¨ ë©”ì„œë“œë“¤ ===

    /**
     * í—¤ë” ì¶”ê°€/ì„¤ì •
     * í‚¤ëŠ” ìë™ìœ¼ë¡œ ì†Œë¬¸ìë¡œ ì •ê·œí™”ë©ë‹ˆë‹¤ (HTTP í—¤ë”ëŠ” ëŒ€ì†Œë¬¸ì ë¬´ê´€)
     */
    public void addHeader(String key, String value) {
        headers.put(key.toLowerCase(), value);              // ì†Œë¬¸ìë¡œ ì •ê·œí™”í•˜ì—¬ ì €ì¥
    }

    /**
     * í—¤ë” ì¡°íšŒ
     * ëŒ€ì†Œë¬¸ì ë¬´ê´€í•˜ê²Œ ì¡°íšŒ ê°€ëŠ¥
     */
    public String getHeader(String key) {
        return headers.get(key.toLowerCase());              // ì†Œë¬¸ìë¡œ ì •ê·œí™”í•˜ì—¬ ì¡°íšŒ
    }

    /**
     * ì „ì²´ í—¤ë” Map ë°˜í™˜ (ë°©ì–´ì  ë³µì‚¬)
     */
    public Map<String, String> getHeaders() {
        return new HashMap<>(headers);                      // ë°©ì–´ì  ë³µì‚¬ë¡œ ì™¸ë¶€ ìˆ˜ì • ë°©ì§€
    }
    
    /**
     * í—¤ë” ì¡´ì¬ ì—¬ë¶€ í™•ì¸
     */
    public boolean hasHeader(String key) {
        return headers.containsKey(key.toLowerCase());      // ì†Œë¬¸ìë¡œ ì •ê·œí™”í•˜ì—¬ í™•ì¸
    }

    // === í¸ì˜ ë©”ì„œë“œë“¤ ===

    /**
     * Content-Type í—¤ë” í¸ì˜ ë©”ì„œë“œ
     * íŒŒì¼ ì—…ë¡œë“œì—ì„œ "multipart/form-data" í™•ì¸ ë“±ì— ìì£¼ ì‚¬ìš©
     */
    public String getContentType() {
        return getHeader("Content-Type");
    }
    
    /**
     * Content-Length í—¤ë” í¸ì˜ ë©”ì„œë“œ
     * ìš”ì²­ ë³¸ë¬¸ì˜ í¬ê¸° í™•ì¸
     */
    public long getContentLength() {
        String contentLength = getHeader("Content-Length");
        if (contentLength != null) {
            try {
                return Long.parseLong(contentLength);       // ë¬¸ìì—´ì„ ìˆ«ìë¡œ ë³€í™˜
            } catch (NumberFormatException e) {
                return -1;                                  // íŒŒì‹± ì‹¤íŒ¨ ì‹œ -1 ë°˜í™˜
            }
        }
        return -1;                                          // í—¤ë”ê°€ ì—†ìœ¼ë©´ -1 ë°˜í™˜
    }

    /**
     * ìš”ì²­ì´ íŠ¹ì • Content-Typeì¸ì§€ í™•ì¸
     * "multipart/form-data; boundary=..." ê°™ì€ ê²½ìš°ë„ ì²˜ë¦¬
     */
    public boolean isContentType(String contentType) {
        String actualContentType = getContentType();
        return actualContentType != null && 
               actualContentType.toLowerCase().startsWith(contentType.toLowerCase());  // ëŒ€ì†Œë¬¸ì ë¬´ê´€ ë¹„êµ
    }
    
    /**
     * POST ìš”ì²­ì¸ì§€ í™•ì¸
     */
    public boolean isPost() {
        return "POST".equals(method);
    }
    
    /**
     * GET ìš”ì²­ì¸ì§€ í™•ì¸
     */
    public boolean isGet() {
        return "GET".equals(method);
    }

    /**
     * ë””ë²„ê¹…ì„ ìœ„í•œ ë¬¸ìì—´ í‘œí˜„
     * ë¯¼ê°í•œ ì •ë³´ëŠ” ì œì™¸í•˜ê³  ìš”ì•½ ì •ë³´ë§Œ í‘œì‹œ
     */
    @Override
    public String toString() {
        return "HttpRequest{" +
                "method='" + method + '\'' +
                ", path='" + path + '\'' +
                ", parameters=" + parameters.size() + " entries" +  // íŒŒë¼ë¯¸í„° ê°œìˆ˜ë§Œ í‘œì‹œ
                ", headers=" + headers.size() + " entries" +        // í—¤ë” ê°œìˆ˜ë§Œ í‘œì‹œ
                ", contentType='" + getContentType() + '\'' +
                '}';
    }
}
```

---

## 2. MultipartFile.java - íŒŒì¼ ì—…ë¡œë“œ ì¸í„°í˜ì´ìŠ¤

### êµ¬ì¡° ë° ëª©ì 
ì—…ë¡œë“œëœ íŒŒì¼ì„ ì¶”ìƒí™”í•˜ëŠ” ì¸í„°í˜ì´ìŠ¤ë¡œ, Springì˜ MultipartFileì„ ì°¸ê³ í•˜ì—¬ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.

```java
package winter.upload;

import java.io.File;                   // íŒŒì¼ ì‹œìŠ¤í…œì˜ íŒŒì¼ í‘œí˜„
import java.io.IOException;            // ì…ì¶œë ¥ ì˜ˆì™¸
import java.io.InputStream;            // ë°”ì´íŠ¸ ì…ë ¥ ìŠ¤íŠ¸ë¦¼

/**
 * ì—…ë¡œë“œëœ íŒŒì¼ì„ ì¶”ìƒí™”í•˜ëŠ” ì¸í„°í˜ì´ìŠ¤
 * HTTP multipart/form-data ìš”ì²­ì—ì„œ ì—…ë¡œë“œëœ íŒŒì¼ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.
 * 
 * ì´ ì¸í„°í˜ì´ìŠ¤ëŠ” Springì˜ MultipartFileì„ ì°¸ê³ í•˜ì—¬ ì„¤ê³„ë˜ì—ˆìœ¼ë©°,
 * íŒŒì¼ì˜ ë©”íƒ€ë°ì´í„°ì™€ ë‚´ìš©ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ë©”ì„œë“œë“¤ì„ ì œê³µí•©ë‹ˆë‹¤.
 * 
 * ì„¤ê³„ ì›ì¹™:
 * - íŒŒì¼ í¬ê¸°ì— ê´€ê³„ì—†ì´ ì¼ê´€ëœ ì¸í„°í˜ì´ìŠ¤ ì œê³µ
 * - ë©”ëª¨ë¦¬ íš¨ìœ¨ì ì¸ ì²˜ë¦¬ ì§€ì› (ìŠ¤íŠ¸ë¦¼ ê¸°ë°˜)
 * - ì•ˆì „í•œ íŒŒì¼ ì €ì¥ ë©”ì»¤ë‹ˆì¦˜
 */
public interface MultipartFile {
    
    /**
     * HTML í¼ì—ì„œ ì‚¬ìš©ëœ í•„ë“œëª…ì„ ë°˜í™˜í•©ë‹ˆë‹¤.
     * 
     * HTML ì˜ˆì‹œ: <input type="file" name="avatar"> â†’ "avatar"
     * í•˜ë‚˜ì˜ ìš”ì²­ì—ì„œ ì—¬ëŸ¬ íŒŒì¼ í•„ë“œê°€ ìˆì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ êµ¬ë¶„ì ì—­í• 
     * 
     * @return í¼ í•„ë“œëª… (never null, ë¹ˆ ë¬¸ìì—´ ê°€ëŠ¥)
     */
    String getName();
    
    /**
     * í´ë¼ì´ì–¸íŠ¸ê°€ ì—…ë¡œë“œí•œ ì›ë³¸ íŒŒì¼ëª…ì„ ë°˜í™˜í•©ë‹ˆë‹¤.
     * 
     * ì˜ˆì‹œ: "profile.jpg", "document.pdf", "resume.docx"
     * 
     * ì£¼ì˜ì‚¬í•­:
     * - ë³´ì•ˆìƒ ê²½ë¡œ ì •ë³´ê°€ í¬í•¨ë  ìˆ˜ ìˆìŒ (C:\Users\john\photo.jpg)
     * - íŒŒì¼ëª…ì— ìœ„í—˜í•œ ë¬¸ìê°€ í¬í•¨ë  ìˆ˜ ìˆìŒ (../../../etc/passwd)
     * - ì„œë²„ì— ì €ì¥í•  ë•ŒëŠ” ë°˜ë“œì‹œ sanitize í•„ìš”
     * 
     * @return ì›ë³¸ íŒŒì¼ëª…, íŒŒì¼ì´ ì„ íƒë˜ì§€ ì•Šì•˜ë‹¤ë©´ ë¹ˆ ë¬¸ìì—´
     */
    String getOriginalFilename();
    
    /**
     * íŒŒì¼ì˜ Content-Typeì„ ë°˜í™˜í•©ë‹ˆë‹¤.
     * 
     * ì˜ˆì‹œ: "image/jpeg", "application/pdf", "text/plain"
     * 
     * ìš©ë„:
     * - íŒŒì¼ ìœ í˜• ê²€ì¦ (ì´ë¯¸ì§€ë§Œ í—ˆìš©, ë¬¸ì„œë§Œ í—ˆìš© ë“±)
     * - ì ì ˆí•œ ì²˜ë¦¬ê¸° ì„ íƒ
     * - HTTP ì‘ë‹µ ì‹œ Content-Type ì„¤ì •
     * 
     * ì£¼ì˜ì‚¬í•­:
     * - í´ë¼ì´ì–¸íŠ¸ê°€ ì œê³µí•˜ëŠ” ì •ë³´ì´ë¯€ë¡œ ì‹ ë¢°í•  ìˆ˜ ì—†ìŒ
     * - ì‹¤ì œ íŒŒì¼ ë‚´ìš©ê³¼ ë‹¤ë¥¼ ìˆ˜ ìˆìŒ (ë³´ì•ˆ ê²€ì¦ í•„ìš”)
     * 
     * @return Content-Type, ì•Œ ìˆ˜ ì—†ë‹¤ë©´ null
     */
    String getContentType();
    
    /**
     * ì—…ë¡œë“œëœ íŒŒì¼ì´ ë¹„ì–´ìˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.
     * 
     * ë¹„ì–´ìˆëŠ” ê²½ìš°:
     * - íŒŒì¼ì´ ì„ íƒë˜ì§€ ì•ŠìŒ (<input type="file">ì—ì„œ ì„ íƒ ì•ˆí•¨)
     * - í¬ê¸°ê°€ 0ì¸ íŒŒì¼
     * - null íŒŒì¼
     * 
     * ìš©ë„:
     * - í•„ìˆ˜ íŒŒì¼ ì—…ë¡œë“œ ê²€ì¦
     * - ë¶ˆí•„ìš”í•œ ì²˜ë¦¬ ë°©ì§€
     * 
     * @return íŒŒì¼ì´ ë¹„ì–´ìˆê±°ë‚˜ ì—…ë¡œë“œë˜ì§€ ì•Šì•˜ë‹¤ë©´ true
     */
    boolean isEmpty();
    
    /**
     * íŒŒì¼ì˜ í¬ê¸°ë¥¼ ë°”ì´íŠ¸ ë‹¨ìœ„ë¡œ ë°˜í™˜í•©ë‹ˆë‹¤.
     * 
     * ìš©ë„:
     * - íŒŒì¼ í¬ê¸° ì œí•œ ê²€ì¦ (ì˜ˆ: 10MB ì´í•˜ë§Œ í—ˆìš©)
     * - ë””ìŠ¤í¬ ê³µê°„ í™•ì¸
     * - ì§„í–‰ë¥  í‘œì‹œ
     * - ë¡œê¹… ë° í†µê³„
     * 
     * @return íŒŒì¼ í¬ê¸° (ë°”ì´íŠ¸), ìŒìˆ˜ë©´ ì•Œ ìˆ˜ ì—†ìŒ
     */
    long getSize();
    
    /**
     * íŒŒì¼ì˜ ì „ì²´ ë‚´ìš©ì„ byte ë°°ì—´ë¡œ ë°˜í™˜í•©ë‹ˆë‹¤.
     * 
     * ì£¼ì˜ì‚¬í•­:
     * - ëŒ€ìš©ëŸ‰ íŒŒì¼ì˜ ê²½ìš° ë©”ëª¨ë¦¬ ë¶€ì¡± ìœ„í—˜!
     * - íŒŒì¼ ì „ì²´ë¥¼ ë©”ëª¨ë¦¬ì— ë¡œë“œí•¨
     * - ê°€ëŠ¥í•˜ë©´ getInputStream() ì‚¬ìš© ê¶Œì¥
     * 
     * ì ì ˆí•œ ì‚¬ìš© ê²½ìš°:
     * - ì‘ì€ íŒŒì¼ (1MB ë¯¸ë§Œ)
     * - íŒŒì¼ ë‚´ìš© ì „ì²´ë¥¼ í•œ ë²ˆì— ì²˜ë¦¬í•´ì•¼ í•˜ëŠ” ê²½ìš°
     * - ì•”í˜¸í™”/í•´ì‹œ ê³„ì‚° ë“±
     * 
     * @return íŒŒì¼ ë‚´ìš© (ë³µì‚¬ë³¸)
     * @throws IOException íŒŒì¼ ì½ê¸° ì‹¤íŒ¨ì‹œ
     */
    byte[] getBytes() throws IOException;
    
    /**
     * íŒŒì¼ ë‚´ìš©ì„ ì½ì„ ìˆ˜ ìˆëŠ” InputStreamì„ ë°˜í™˜í•©ë‹ˆë‹¤.
     * 
     * ì¥ì :
     * - ë©”ëª¨ë¦¬ íš¨ìœ¨ì  (ì²­í¬ ë‹¨ìœ„ë¡œ ì½ê¸°)
     * - ëŒ€ìš©ëŸ‰ íŒŒì¼ ì²˜ë¦¬ ê°€ëŠ¥
     * - ìŠ¤íŠ¸ë¦¼ ì²´ì´ë‹ ê°€ëŠ¥ (BufferedInputStream ë“±ê³¼ ì¡°í•©)
     * 
     * ì‚¬ìš© íŒ¨í„´:
     * try (InputStream is = file.getInputStream()) {
     *     // íŒŒì¼ ì²˜ë¦¬
     * } // ìë™ìœ¼ë¡œ close() í˜¸ì¶œ
     * 
     * ì£¼ì˜ì‚¬í•­:
     * - ì‚¬ìš© í›„ ë°˜ë“œì‹œ close() í˜¸ì¶œ í•„ìš”
     * - try-with-resources êµ¬ë¬¸ ì‚¬ìš© ê¶Œì¥
     * 
     * @return íŒŒì¼ ë‚´ìš© ìŠ¤íŠ¸ë¦¼
     * @throws IOException ìŠ¤íŠ¸ë¦¼ ìƒì„± ì‹¤íŒ¨ì‹œ
     */
    InputStream getInputStream() throws IOException;
    
    /**
     * ì—…ë¡œë“œëœ íŒŒì¼ì„ ì§€ì •ëœ ìœ„ì¹˜ì— ì €ì¥í•©ë‹ˆë‹¤.
     * 
     * íŠ¹ì§•:
     * - ë©”ëª¨ë¦¬ íš¨ìœ¨ì ì¸ ì €ì¥ (ìŠ¤íŠ¸ë¦¼ ê¸°ë°˜)
     * - ëŒ€ìš©ëŸ‰ íŒŒì¼ë„ ì•ˆì „í•˜ê²Œ ì²˜ë¦¬
     * - ì›ìì  ì—°ì‚° (ì„±ê³µ ë˜ëŠ” ì‹¤íŒ¨, ì¤‘ê°„ ìƒíƒœ ì—†ìŒ)
     * 
     * ë‚´ë¶€ ì²˜ë¦¬:
     * 1. ëŒ€ìƒ ë””ë ‰í† ë¦¬ ì¡´ì¬ í™•ì¸ ë° ìƒì„±
     * 2. ì„ì‹œ íŒŒì¼ë¡œ ì €ì¥ í›„ ì›ë³¸ìœ¼ë¡œ ì´ë™ (ì›ìì  ì²˜ë¦¬)
     * 3. íŒŒì¼ ê¶Œí•œ ì„¤ì •
     * 4. ë©”íƒ€ë°ì´í„° ë³´ì¡´
     * 
     * ì˜ˆì™¸ ìƒí™©:
     * - ë””ìŠ¤í¬ ê³µê°„ ë¶€ì¡±
     * - ê¶Œí•œ ë¶€ì¡±
     * - ëŒ€ìƒ íŒŒì¼ì´ ì´ë¯¸ ì¡´ì¬í•˜ê³  ì“°ê¸° ë¶ˆê°€
     * 
     * @param dest ì €ì¥í•  íŒŒì¼ ìœ„ì¹˜ (ë””ë ‰í† ë¦¬ + íŒŒì¼ëª…)
     * @throws IOException íŒŒì¼ ì €ì¥ ì‹¤íŒ¨ì‹œ
     * @throws IllegalStateException íŒŒì¼ì´ ì´ë¯¸ ì²˜ë¦¬ë˜ì—ˆê±°ë‚˜ ì´ë™í•  ìˆ˜ ì—†ëŠ” ìƒíƒœì¼ ë•Œ
     */
    void transferTo(File dest) throws IOException;
}
```

---

## 3. StandardMultipartFile.java - MultipartFile êµ¬í˜„ì²´

### êµ¬ì¡° ë° ëª©ì 
MultipartFile ì¸í„°í˜ì´ìŠ¤ì˜ í‘œì¤€ êµ¬í˜„ì²´ë¡œ, íŒŒì¼ ë°ì´í„°ë¥¼ ë©”ëª¨ë¦¬ì— ì €ì¥í•˜ì—¬ ê´€ë¦¬í•©ë‹ˆë‹¤.

```java
package winter.upload;

import java.io.*;                      // ì…ì¶œë ¥ ê´€ë ¨ í´ë˜ìŠ¤ë“¤
import java.nio.file.Files;            // NIO íŒŒì¼ ì‘ì—… ìœ í‹¸ë¦¬í‹°
import java.nio.file.StandardCopyOption; // íŒŒì¼ ë³µì‚¬ ì˜µì…˜

/**
 * MultipartFileì˜ í‘œì¤€ êµ¬í˜„ì²´
 * 
 * ì„¤ê³„ íŠ¹ì§•:
 * - íŒŒì¼ ë‚´ìš©ì„ byte ë°°ì—´ë¡œ ë©”ëª¨ë¦¬ì— ì €ì¥
 * - ë¶ˆë³€ ê°ì²´ (immutable) - ìƒì„± í›„ ë‚´ìš© ë³€ê²½ ë¶ˆê°€
 * - ë°©ì–´ì  ë³µì‚¬ë¥¼ í†µí•œ ë°ì´í„° ë³´í˜¸
 * - ì‘ì€ íŒŒì¼ì— ìµœì í™”ë¨
 * 
 * ì í•©í•œ ì‚¬ìš© ì‚¬ë¡€:
 * - ì¼ë°˜ì ì¸ ì›¹ íŒŒì¼ ì—…ë¡œë“œ (10MB ì´í•˜)
 * - íŒŒì¼ ë‚´ìš©ì— ì—¬ëŸ¬ ë²ˆ ì ‘ê·¼í•´ì•¼ í•˜ëŠ” ê²½ìš°
 * - íŒŒì¼ ê²€ì¦ ë° ì²˜ë¦¬ê°€ í•„ìš”í•œ ê²½ìš°
 * 
 * ë¶€ì í•©í•œ ì‚¬ìš© ì‚¬ë¡€:
 * - ëŒ€ìš©ëŸ‰ íŒŒì¼ (100MB ì´ìƒ) - ë©”ëª¨ë¦¬ ë¶€ì¡± ìœ„í—˜
 * - íŒŒì¼ ë‚´ìš©ì„ í•œ ë²ˆë§Œ ì½ëŠ” ê²½ìš° - ë¶ˆí•„ìš”í•œ ë©”ëª¨ë¦¬ ì‚¬ìš©
 * - ìŠ¤íŠ¸ë¦¬ë° ì²˜ë¦¬ê°€ í•„ìš”í•œ ê²½ìš°
 */
public class StandardMultipartFile implements MultipartFile {
    
    // === ë¶ˆë³€ í•„ë“œë“¤ (finalë¡œ ì„ ì–¸) ===
    private final String name;                              // HTML í¼ í•„ë“œëª… (ì˜ˆ: "avatar", "document")
    private final String originalFilename;                 // í´ë¼ì´ì–¸íŠ¸ì˜ ì›ë³¸ íŒŒì¼ëª… (ì˜ˆ: "photo.jpg")
    private final String contentType;                      // MIME íƒ€ì… (ì˜ˆ: "image/jpeg", "application/pdf")
    private final byte[] content;                          // íŒŒì¼ ë‚´ìš© (ë¶ˆë³€ ë°°ì—´)
    
    /**
     * StandardMultipartFile ìƒì„±ì
     * 
     * ëª¨ë“  íŒŒë¼ë¯¸í„°ëŠ” ë°©ì–´ì ìœ¼ë¡œ ì²˜ë¦¬ë˜ì–´ null-safeë¥¼ ë³´ì¥í•©ë‹ˆë‹¤.
     * 
     * @param name í¼ í•„ë“œëª… (nullì´ë©´ ë¹ˆ ë¬¸ìì—´ë¡œ ì²˜ë¦¬)
     * @param originalFilename ì›ë³¸ íŒŒì¼ëª… (nullì´ë©´ ë¹ˆ ë¬¸ìì—´ë¡œ ì²˜ë¦¬)
     * @param contentType MIME íƒ€ì… (null í—ˆìš©)
     * @param content íŒŒì¼ ë‚´ìš© (nullì´ë©´ ë¹ˆ ë°°ì—´ë¡œ ì²˜ë¦¬)
     */
    public StandardMultipartFile(String name, String originalFilename, 
                               String contentType, byte[] content) {
        // null-safe ì²˜ë¦¬: nullì´ ë“¤ì–´ì™€ë„ ì•ˆì „í•˜ê²Œ ì²˜ë¦¬
        this.name = name != null ? name : "";               // nullì´ë©´ ë¹ˆ ë¬¸ìì—´
        this.originalFilename = originalFilename != null ? originalFilename : "";  // nullì´ë©´ ë¹ˆ ë¬¸ìì—´
        this.contentType = contentType;                     // null í—ˆìš© (MIME íƒ€ì…ì´ ì—†ì„ ìˆ˜ ìˆìŒ)
        this.content = content != null ? content : new byte[0];  // nullì´ë©´ ë¹ˆ ë°°ì—´ (ê¸¸ì´ 0)
    }
    
    // === MultipartFile ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„ ===
    
    /**
     * í¼ í•„ë“œëª… ë°˜í™˜
     * @return HTML formì˜ input name ì†ì„±ê°’
     */
    @Override
    public String getName() {
        return name;
    }
    
    /**
     * ì›ë³¸ íŒŒì¼ëª… ë°˜í™˜
     * @return í´ë¼ì´ì–¸íŠ¸ê°€ ì—…ë¡œë“œí•œ íŒŒì¼ì˜ ì›ë˜ ì´ë¦„
     */
    @Override
    public String getOriginalFilename() {
        return originalFilename;
    }
    
    /**
     * Content-Type ë°˜í™˜
     * @return MIME íƒ€ì… ë¬¸ìì—´ ë˜ëŠ” null
     */
    @Override
    public String getContentType() {
        return contentType;
    }
    
    /**
     * íŒŒì¼ì´ ë¹„ì–´ìˆëŠ”ì§€ í™•ì¸
     * @return íŒŒì¼ ë‚´ìš©ì´ ì—†ìœ¼ë©´ true
     */
    @Override
    public boolean isEmpty() {
        return content.length == 0;                         // ë°°ì—´ ê¸¸ì´ê°€ 0ì´ë©´ ë¹ˆ íŒŒì¼
    }
    
    /**
     * íŒŒì¼ í¬ê¸° ë°˜í™˜
     * @return ë°”ì´íŠ¸ ë‹¨ìœ„ íŒŒì¼ í¬ê¸°
     */
    @Override
    public long getSize() {
        return content.length;                              // ë°°ì—´ ê¸¸ì´ = íŒŒì¼ í¬ê¸°
    }
    
    /**
     * íŒŒì¼ ë‚´ìš©ì„ byte ë°°ì—´ë¡œ ë°˜í™˜
     * 
     * ë°©ì–´ì  ë³µì‚¬(defensive copy)ë¥¼ ìˆ˜í–‰í•˜ì—¬ ì›ë³¸ ë°ì´í„°ë¥¼ ë³´í˜¸í•©ë‹ˆë‹¤.
     * ë°˜í™˜ëœ ë°°ì—´ì„ ìˆ˜ì •í•´ë„ ì›ë³¸ì—ëŠ” ì˜í–¥ì´ ì—†ìŠµë‹ˆë‹¤.
     * 
     * @return íŒŒì¼ ë‚´ìš©ì˜ ë³µì‚¬ë³¸
     * @throws IOException ì‹¤ì œë¡œëŠ” ë°œìƒí•˜ì§€ ì•ŠìŒ (ë©”ëª¨ë¦¬ ê¸°ë°˜ì´ë¯€ë¡œ)
     */
    @Override
    public byte[] getBytes() throws IOException {
        return content.clone();                             // ë°°ì—´ ë³µì‚¬ë³¸ ë°˜í™˜ (ì›ë³¸ ë³´í˜¸)
    }
    
    /**
     * íŒŒì¼ ë‚´ìš©ì„ ì½ì„ ìˆ˜ ìˆëŠ” InputStream ë°˜í™˜
     * 
     * ByteArrayInputStreamì„ ì‚¬ìš©í•˜ì—¬ ë©”ëª¨ë¦¬ì˜ byte ë°°ì—´ì„
     * InputStreamìœ¼ë¡œ ë˜í•‘í•©ë‹ˆë‹¤.
     * 
     * íŠ¹ì§•:
     * - ë©”ëª¨ë¦¬ ê¸°ë°˜ì´ë¯€ë¡œ ë¹ ë¦„
     * - mark/reset ì§€ì›
     * - thread-safeí•˜ì§€ ì•ŠìŒ (ë™ì‹œ ì ‘ê·¼ ì£¼ì˜)
     * 
     * @return íŒŒì¼ ë‚´ìš©ì„ ì½ì„ ìˆ˜ ìˆëŠ” InputStream
     * @throws IOException ì‹¤ì œë¡œëŠ” ë°œìƒí•˜ì§€ ì•ŠìŒ
     */
    @Override
    public InputStream getInputStream() throws IOException {
        return new ByteArrayInputStream(content);           // ë©”ëª¨ë¦¬ ê¸°ë°˜ InputStream ìƒì„±
    }
    
    /**
     * íŒŒì¼ì„ ì§€ì •ëœ ìœ„ì¹˜ì— ì €ì¥
     * 
     * ì²˜ë¦¬ ìˆœì„œ:
     * 1. ëŒ€ìƒ íŒŒì¼ null ì²´í¬
     * 2. ë¶€ëª¨ ë””ë ‰í† ë¦¬ ì¡´ì¬ í™•ì¸ ë° ìƒì„±
     * 3. NIO Files.copy()ë¥¼ ì‚¬ìš©í•œ ì•ˆì „í•œ íŒŒì¼ ë³µì‚¬
     * 
     * @param dest ì €ì¥í•  íŒŒì¼ ìœ„ì¹˜
     * @throws IOException íŒŒì¼ ì €ì¥ ì‹¤íŒ¨ì‹œ
     */
    @Override
    public void transferTo(File dest) throws IOException {
        // 1. ì…ë ¥ ê²€ì¦
        if (dest == null) {
            throw new IllegalArgumentException("Destination file cannot be null");
        }
        
        // 2. ëª©ì ì§€ ë””ë ‰í† ë¦¬ê°€ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ ìƒì„±
        File parentDir = dest.getParentFile();              // ë¶€ëª¨ ë””ë ‰í† ë¦¬ ê°€ì ¸ì˜¤ê¸°
        if (parentDir != null && !parentDir.exists()) {     // ë¶€ëª¨ ë””ë ‰í† ë¦¬ê°€ ì—†ìœ¼ë©´
            if (!parentDir.mkdirs()) {                       // ë””ë ‰í† ë¦¬ ìƒì„± ì‹œë„
                throw new IOException("Could not create directory: " + parentDir.getAbsolutePath());
            }
        }
        
        // 3. íŒŒì¼ ì €ì¥ (NIO ì‚¬ìš©)
        try (InputStream is = getInputStream()) {            // try-with-resourcesë¡œ ìë™ close
            Files.copy(is, dest.toPath(), StandardCopyOption.REPLACE_EXISTING);  // íŒŒì¼ ë³µì‚¬
            // REPLACE_EXISTING: ëŒ€ìƒ íŒŒì¼ì´ ì´ë¯¸ ì¡´ì¬í•˜ë©´ ë®ì–´ì“°ê¸°
        }
    }
    
    // === Object í´ë˜ìŠ¤ ë©”ì„œë“œ ì˜¤ë²„ë¼ì´ë“œ ===
    
    /**
     * ë””ë²„ê¹…ì„ ìœ„í•œ ë¬¸ìì—´ í‘œí˜„
     * íŒŒì¼ ë‚´ìš©ì€ í‘œì‹œí•˜ì§€ ì•Šê³  ë©”íƒ€ë°ì´í„°ë§Œ í‘œì‹œ
     */
    @Override
    public String toString() {
        return "StandardMultipartFile{" +
                "name='" + name + '\'' +                    // í•„ë“œëª…
                ", originalFilename='" + originalFilename + '\'' +  // ì›ë³¸ íŒŒì¼ëª…
                ", contentType='" + contentType + '\'' +    // MIME íƒ€ì…
                ", size=" + getSize() +                     // íŒŒì¼ í¬ê¸°
                ", isEmpty=" + isEmpty() +                  // ë¹ˆ íŒŒì¼ ì—¬ë¶€
                '}';
    }
    
    /**
     * ê°ì²´ ë™ë“±ì„± ë¹„êµ
     * 
     * ë™ë“±ì„± ê¸°ì¤€:
     * 1. ê°™ì€ ì°¸ì¡°ë©´ true (ì„±ëŠ¥ ìµœì í™”)
     * 2. nullì´ê±°ë‚˜ ë‹¤ë¥¸ í´ë˜ìŠ¤ë©´ false
     * 3. ëª¨ë“  í•„ë“œê°€ ê°™ìœ¼ë©´ true
     * 
     * Arrays.equals() ì‚¬ìš© ì´ìœ :
     * - ë°°ì—´ì€ == ì—°ì‚°ìë¡œ ë¹„êµí•˜ë©´ ì°¸ì¡°ë§Œ ë¹„êµë¨
     * - Arrays.equals()ëŠ” ë°°ì—´ì˜ ë‚´ìš©ì„ ë¹„êµí•¨
     * - null ë°°ì—´ë„ ì•ˆì „í•˜ê²Œ ì²˜ë¦¬
     */
    @Override
    public boolean equals(Object obj) {
        if (this == obj) return true;                       // 1. ì°¸ì¡° ë™ë“±ì„± (ë¹ ë¥¸ ê²½ë¡œ)
        if (obj == null || getClass() != obj.getClass()) return false;  // 2. null ë° íƒ€ì… ì²´í¬
        
        StandardMultipartFile that = (StandardMultipartFile) obj;  // 3. í˜•ë³€í™˜
        return name.equals(that.name) &&                   // 4. í•„ë“œë³„ ë¹„êµ
               originalFilename.equals(that.originalFilename) &&
               (contentType != null ? contentType.equals(that.contentType) : that.contentType == null) &&
               java.util.Arrays.equals(content, that.content);  // ë°°ì—´ ë‚´ìš© ë¹„êµ
    }
    
    /**
     * í•´ì‹œì½”ë“œ ê³„ì‚°
     * 
     * equals()ê°€ trueì¸ ê°ì²´ë“¤ì€ ê°™ì€ í•´ì‹œì½”ë“œë¥¼ ê°€ì ¸ì•¼ í•¨ (í•´ì‹œì½”ë“œ ê³„ì•½)
     * 
     * ê³„ì‚° ë°©ì‹:
     * 1. name.hashCode()ë¡œ ì‹œì‘
     * 2. 31ì„ ê³±í•˜ê³  ë‹¤ìŒ í•„ë“œì˜ í•´ì‹œì½”ë“œ ì¶”ê°€
     * 3. null í•„ë“œëŠ” 0ìœ¼ë¡œ ì²˜ë¦¬
     * 4. ë°°ì—´ì€ Arrays.hashCode() ì‚¬ìš©
     * 
     * 31ì„ ì‚¬ìš©í•˜ëŠ” ì´ìœ :
     * - í™€ìˆ˜ ì†Œìˆ˜ë¡œ í•´ì‹œ ë¶„ì‚°ì„±ì´ ì¢‹ìŒ
     * - 31 * i == (i << 5) - ië¡œ ìµœì í™” ê°€ëŠ¥
     * - String í´ë˜ìŠ¤ì—ì„œë„ ë™ì¼í•˜ê²Œ ì‚¬ìš©
     */
    @Override
    public int hashCode() {
        int result = name.hashCode();                       // ì²« ë²ˆì§¸ í•„ë“œì˜ í•´ì‹œì½”ë“œ
        result = 31 * result + originalFilename.hashCode(); // 31 ê³±í•˜ê³  ë‹¤ìŒ í•„ë“œ ì¶”ê°€
        result = 31 * result + (contentType != null ? contentType.hashCode() : 0);  // null ì•ˆì „ ì²˜ë¦¬
        result = 31 * result + java.util.Arrays.hashCode(content);  // ë°°ì—´ í•´ì‹œì½”ë“œ
        return result;
    }
}
```

---

## 4. MultipartRequest.java - Multipart ìš”ì²­ í™•ì¥ í´ë˜ìŠ¤

### êµ¬ì¡° ë° ëª©ì 
HttpRequestë¥¼ í™•ì¥í•˜ì—¬ íŒŒì¼ ì—…ë¡œë“œê°€ í¬í•¨ëœ multipart/form-data ìš”ì²­ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤.

```java
package winter.upload;

import winter.http.HttpRequest;         // ê¸°ë³¸ HTTP ìš”ì²­ í´ë˜ìŠ¤
import java.io.BufferedReader;          // í…ìŠ¤íŠ¸ ìŠ¤íŠ¸ë¦¼ ì½ê¸°
import java.util.*;                     // ì»¬ë ‰ì…˜ í”„ë ˆì„ì›Œí¬

/**
 * Multipart ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” HttpRequest í™•ì¥ í´ë˜ìŠ¤
 * 
 * multipart/form-data í˜•íƒœì˜ ìš”ì²­ì—ì„œ íŒŒì¼ê³¼ ì¼ë°˜ íŒŒë¼ë¯¸í„°ë¥¼ ë¶„ë¦¬í•˜ì—¬ ê´€ë¦¬í•©ë‹ˆë‹¤.
 * 
 * ì„¤ê³„ ì›ì¹™:
 * - HttpRequestì˜ ëª¨ë“  ê¸°ëŠ¥ì„ ìƒì†
 * - íŒŒì¼ ê´€ë ¨ ê¸°ëŠ¥ì„ ì¶”ê°€ë¡œ ì œê³µ
 * - ì¼ë°˜ íŒŒë¼ë¯¸í„°ì™€ íŒŒì¼ì„ ëª…í™•íˆ êµ¬ë¶„
 * - ë‹¤ì¤‘ íŒŒì¼ ì—…ë¡œë“œ ì§€ì›
 * 
 * ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤:
 * - íŒŒì¼ ì—…ë¡œë“œê°€ í¬í•¨ëœ í¼ ì œì¶œ
 * - í”„ë¡œí•„ ì •ë³´ + ì•„ë°”íƒ€ ì´ë¯¸ì§€ ì—…ë¡œë“œ
 * - ë¬¸ì„œ + ì²¨ë¶€íŒŒì¼ ì—…ë¡œë“œ
 * - Ajax íŒŒì¼ ì—…ë¡œë“œ
 */
public class MultipartRequest extends HttpRequest {
    
    // === íŒŒì¼ ê´€ë¦¬ í•„ë“œ ===
    private final Map<String, List<MultipartFile>> files;  // í•„ë“œëª… -> íŒŒì¼ ë¦¬ìŠ¤íŠ¸ ë§µ
    
    /**
     * MultipartRequest ìƒì„±ì
     * 
     * ë¶€ëª¨ í´ë˜ìŠ¤(HttpRequest)ì˜ ìƒì„±ìë¥¼ í˜¸ì¶œí•˜ê³ 
     * íŒŒì¼ ë§µì„ ì¶”ê°€ë¡œ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.
     * 
     * @param method HTTP ë©”ì„œë“œ ("POST", "PUT" ë“±)
     * @param path ìš”ì²­ ê²½ë¡œ ("/upload", "/api/files" ë“±)
     * @param headers HTTP í—¤ë” ë§µ (Content-Type ë“±)
     * @param parameters ì¼ë°˜ íŒŒë¼ë¯¸í„° ë§µ (í…ìŠ¤íŠ¸ í•„ë“œë“¤)
     * @param body ìš”ì²­ ë³¸ë¬¸ BufferedReader (multipart ë°ì´í„°)
     * @param files ì—…ë¡œë“œëœ íŒŒì¼ ë§µ (íŒŒì¼ í•„ë“œë“¤)
     */
    public MultipartRequest(String method, String path, Map<String, String> headers, 
                          Map<String, List<String>> parameters, BufferedReader body, 
                          Map<String, List<MultipartFile>> files) {
        // ë¶€ëª¨ í´ë˜ìŠ¤ ìƒì„±ì í˜¸ì¶œ (HttpRequest ì´ˆê¸°í™”)
        super(method, path, headers, parameters, body);
        
        // íŒŒì¼ ë§µ ì´ˆê¸°í™” (null-safe ì²˜ë¦¬)
        this.files = files != null ? files : new HashMap<>();
    }
    
    // === ë‹¨ì¼ íŒŒì¼ ì ‘ê·¼ ë©”ì„œë“œë“¤ ===
    
    /**
     * ì§€ì •ëœ ì´ë¦„ì˜ ì²« ë²ˆì§¸ íŒŒì¼ì„ ë°˜í™˜í•©ë‹ˆë‹¤.
     * 
     * ì‚¬ìš© ì‚¬ë¡€:
     * - ë‹¨ì¼ íŒŒì¼ ì—…ë¡œë“œ (<input type="file" name="avatar">)
     * - ë‹¤ì¤‘ íŒŒì¼ ì¤‘ ì²« ë²ˆì§¸ë§Œ í•„ìš”í•œ ê²½ìš°
     * 
     * @param name íŒŒì¼ í•„ë“œëª… (HTMLì˜ input name)
     * @return ì—…ë¡œë“œëœ íŒŒì¼, ì—†ìœ¼ë©´ null
     */
    public MultipartFile getFile(String name) {
        List<MultipartFile> fileList = files.get(name);    // í•´ë‹¹ í•„ë“œì˜ íŒŒì¼ ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ
        return (fileList != null && !fileList.isEmpty()) ? fileList.get(0) : null;  // ì²« ë²ˆì§¸ íŒŒì¼ ë°˜í™˜
    }
    
    // === ë‹¤ì¤‘ íŒŒì¼ ì ‘ê·¼ ë©”ì„œë“œë“¤ ===
    
    /**
     * ì§€ì •ëœ ì´ë¦„ì˜ ëª¨ë“  íŒŒì¼ì„ ë°˜í™˜í•©ë‹ˆë‹¤.
     * 
     * ì‚¬ìš© ì‚¬ë¡€:
     * - ë‹¤ì¤‘ íŒŒì¼ ì—…ë¡œë“œ (<input type="file" name="documents" multiple>)
     * - ê°™ì€ ì´ë¦„ì˜ íŒŒì¼ í•„ë“œê°€ ì—¬ëŸ¬ ê°œì¸ ê²½ìš°
     * - íŒŒì¼ ë°°ì—´ ì²˜ë¦¬
     * 
     * @param name íŒŒì¼ í•„ë“œëª…
     * @return ì—…ë¡œë“œëœ íŒŒì¼ ëª©ë¡ (ë°©ì–´ì  ë³µì‚¬ë³¸)
     */
    public List<MultipartFile> getFiles(String name) {
        return new ArrayList<>(files.getOrDefault(name, Collections.emptyList()));  // ë°©ì–´ì  ë³µì‚¬
    }
    
    /**
     * ëª¨ë“  íŒŒì¼ì˜ ë§µì„ ë°˜í™˜í•©ë‹ˆë‹¤.
     * 
     * ì‚¬ìš© ì‚¬ë¡€:
     * - ì „ì²´ íŒŒì¼ ëª©ë¡ ì¡°íšŒ
     * - íŒŒì¼ í†µê³„ ê³„ì‚°
     * - ë¡œê¹… ë° ë””ë²„ê¹…
     * 
     * @return íŒŒì¼ëª… -> íŒŒì¼ ëª©ë¡ ë§µ (ë°©ì–´ì  ë³µì‚¬ë³¸)
     */
    public Map<String, List<MultipartFile>> getFileMap() {
        Map<String, List<MultipartFile>> result = new HashMap<>();
        for (Map.Entry<String, List<MultipartFile>> entry : files.entrySet()) {
            result.put(entry.getKey(), new ArrayList<>(entry.getValue()));  // ê¹Šì€ ë³µì‚¬
        }
        return result;
    }
    
    // === íŒŒì¼ ì¡´ì¬ ì—¬ë¶€ í™•ì¸ ë©”ì„œë“œë“¤ ===
    
    /**
     * ì—…ë¡œë“œëœ íŒŒì¼ì´ ìˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.
     * 
     * í™•ì¸ ì¡°ê±´:
     * 1. files ë§µì´ ë¹„ì–´ìˆì§€ ì•ŠìŒ
     * 2. ì‹¤ì œë¡œ íŒŒì¼ì´ í¬í•¨ëœ ë¦¬ìŠ¤íŠ¸ê°€ ì¡´ì¬í•¨
     * 
     * @return íŒŒì¼ì´ í•˜ë‚˜ë¼ë„ ìˆìœ¼ë©´ true
     */
    public boolean hasFiles() {
        return !files.isEmpty() && files.values().stream()  // ëª¨ë“  íŒŒì¼ ë¦¬ìŠ¤íŠ¸ì— ëŒ€í•´
                .anyMatch(fileList -> !fileList.isEmpty()); // í•˜ë‚˜ë¼ë„ ë¹„ì–´ìˆì§€ ì•Šì€ì§€ í™•ì¸
    }
    
    /**
     * íŠ¹ì • ì´ë¦„ì˜ íŒŒì¼ì´ ìˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.
     * 
     * í™•ì¸ ì¡°ê±´:
     * 1. í•´ë‹¹ í•„ë“œëª…ì´ ì¡´ì¬í•¨
     * 2. í•´ë‹¹ í•„ë“œì— ì‹¤ì œ íŒŒì¼ì´ ìˆìŒ (ë¹ˆ ë¦¬ìŠ¤íŠ¸ê°€ ì•„ë‹˜)
     * 
     * @param name íŒŒì¼ í•„ë“œëª…
     * @return í•´ë‹¹ ì´ë¦„ì˜ íŒŒì¼ì´ ìˆìœ¼ë©´ true
     */
    public boolean hasFile(String name) {
        List<MultipartFile> fileList = files.get(name);
        return fileList != null && !fileList.isEmpty();    // nullì´ ì•„ë‹ˆê³  ë¹„ì–´ìˆì§€ ì•ŠìŒ
    }
    
    // === íŒŒì¼ ë©”íƒ€ë°ì´í„° ì¡°íšŒ ë©”ì„œë“œë“¤ ===
    
    /**
     * ì—…ë¡œë“œëœ ëª¨ë“  íŒŒì¼ í•„ë“œëª…ì„ ë°˜í™˜í•©ë‹ˆë‹¤.
     * 
     * ì‚¬ìš© ì‚¬ë¡€:
     * - ì–´ë–¤ íŒŒì¼ í•„ë“œë“¤ì´ ì—…ë¡œë“œë˜ì—ˆëŠ”ì§€ í™•ì¸
     * - ë™ì  íŒŒì¼ ì²˜ë¦¬ (í•„ë“œëª…ì— ë”°ë¼ ë‹¤ë¥¸ ì²˜ë¦¬)
     * - ë¡œê¹… ë° ë””ë²„ê¹…
     * 
     * @return íŒŒì¼ í•„ë“œëª… ì§‘í•© (ë°©ì–´ì  ë³µì‚¬ë³¸)
     */
    public Set<String> getFileNames() {
        return new HashSet<>(files.keySet());              // ë°©ì–´ì  ë³µì‚¬
    }
    
    /**
     * ì´ ì—…ë¡œë“œëœ íŒŒì¼ ê°œìˆ˜ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
     * 
     * ê³„ì‚° ë°©ì‹:
     * - ëª¨ë“  íŒŒì¼ ë¦¬ìŠ¤íŠ¸ì˜ í¬ê¸°ë¥¼ í•©ì‚°
     * - Stream APIë¥¼ ì‚¬ìš©í•œ í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë°
     * 
     * @return ì „ì²´ íŒŒì¼ ê°œìˆ˜
     */
    public int getFileCount() {
        return files.values().stream()                     // ëª¨ë“  íŒŒì¼ ë¦¬ìŠ¤íŠ¸ì— ëŒ€í•´
                .mapToInt(List::size)                       // ê° ë¦¬ìŠ¤íŠ¸ì˜ í¬ê¸°ë¥¼ intë¡œ ë³€í™˜
                .sum();                                     // ëª¨ë“  í¬ê¸°ë¥¼ í•©ì‚°
    }
    
    /**
     * íŠ¹ì • í•„ë“œì˜ íŒŒì¼ ê°œìˆ˜ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
     * 
     * @param name íŒŒì¼ í•„ë“œëª…
     * @return í•´ë‹¹ í•„ë“œì˜ íŒŒì¼ ê°œìˆ˜
     */
    public int getFileCount(String name) {
        List<MultipartFile> fileList = files.get(name);
        return fileList != null ? fileList.size() : 0;     // nullì´ë©´ 0, ì•„ë‹ˆë©´ ë¦¬ìŠ¤íŠ¸ í¬ê¸°
    }
    
    /**
     * ì—…ë¡œë“œëœ ëª¨ë“  íŒŒì¼ì˜ ì´ í¬ê¸°ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
     * 
     * ê³„ì‚° ë°©ì‹:
     * 1. ëª¨ë“  íŒŒì¼ ë¦¬ìŠ¤íŠ¸ë¥¼ í•˜ë‚˜ì˜ ìŠ¤íŠ¸ë¦¼ìœ¼ë¡œ í•©ì¹¨ (flatMap)
     * 2. ê° íŒŒì¼ì˜ í¬ê¸°ë¥¼ longìœ¼ë¡œ ë³€í™˜ (mapToLong)
     * 3. ëª¨ë“  í¬ê¸°ë¥¼ í•©ì‚° (sum)
     * 
     * ì‚¬ìš© ì‚¬ë¡€:
     * - ë””ìŠ¤í¬ ê³µê°„ í™•ì¸
     * - ì—…ë¡œë“œ ì œí•œ ê²€ì¦
     * - í†µê³„ ë° ë¡œê¹…
     * 
     * @return ì´ íŒŒì¼ í¬ê¸° (ë°”ì´íŠ¸)
     */
    public long getTotalFileSize() {
        return files.values().stream()                     // ëª¨ë“  íŒŒì¼ ë¦¬ìŠ¤íŠ¸
                .flatMap(List::stream)                      // í•˜ë‚˜ì˜ íŒŒì¼ ìŠ¤íŠ¸ë¦¼ìœ¼ë¡œ í•©ì¹¨
                .mapToLong(MultipartFile::getSize)          // ê° íŒŒì¼ì˜ í¬ê¸°
                .sum();                                     // ì´í•©
    }
    
    // === Object í´ë˜ìŠ¤ ë©”ì„œë“œ ì˜¤ë²„ë¼ì´ë“œ ===
    
    /**
     * ë””ë²„ê¹…ì„ ìœ„í•œ ë¬¸ìì—´ í‘œí˜„
     * 
     * í‘œì‹œ ì •ë³´:
     * - HTTP ë©”ì„œë“œì™€ ê²½ë¡œ (ë¶€ëª¨ í´ë˜ìŠ¤ì—ì„œ ìƒì†)
     * - íŒŒì¼ ê°œìˆ˜ ë° ì´ í¬ê¸°
     * - íŒŒì¼ í•„ë“œëª… ëª©ë¡
     * 
     * ê°œì¸ì •ë³´ ë³´í˜¸:
     * - íŒŒì¼ ë‚´ìš©ì€ í‘œì‹œí•˜ì§€ ì•ŠìŒ
     * - íŒŒì¼ëª…ë„ ë³´ì•ˆìƒ í‘œì‹œí•˜ì§€ ì•ŠìŒ
     * - í†µê³„ ì •ë³´ë§Œ í‘œì‹œ
     */
    @Override
    public String toString() {
        return "MultipartRequest{" +
                "method='" + getMethod() + '\'' +           // HTTP ë©”ì„œë“œ
                ", path='" + getPath() + '\'' +             // ìš”ì²­ ê²½ë¡œ
                ", fileCount=" + getFileCount() +           // ì´ íŒŒì¼ ê°œìˆ˜
                ", totalFileSize=" + getTotalFileSize() + " bytes" +  // ì´ íŒŒì¼ í¬ê¸°
                ", fileNames=" + getFileNames() +           // íŒŒì¼ í•„ë“œëª…ë“¤
                '}';
    }
}
```

ì´ì œ ëª¨ë“  í•µì‹¬ í´ë˜ìŠ¤ì˜ ìƒì„¸ ë¶„ì„ì´ ì™„ì„±ë˜ì—ˆìŠµë‹ˆë‹¤!

## ğŸ“š ì¢…í•© ìš”ì•½

### ì„¤ê³„ íŒ¨í„´ ë° ì›ì¹™
1. **ì¸í„°í˜ì´ìŠ¤ ë¶„ë¦¬**: MultipartFile ì¸í„°í˜ì´ìŠ¤ë¡œ ì¶”ìƒí™”
2. **ë°©ì–´ì  í”„ë¡œê·¸ë˜ë°**: null ì²´í¬, ë°©ì–´ì  ë³µì‚¬
3. **ë¶ˆë³€ì„±**: final í•„ë“œ, ë°©ì–´ì  ë³µì‚¬ë¡œ ë°ì´í„° ë³´í˜¸
4. **í™•ì¥ì„±**: HttpRequest ìƒì†ìœ¼ë¡œ ê¸°ëŠ¥ í™•ì¥
5. **ë©”ëª¨ë¦¬ íš¨ìœ¨ì„±**: ìŠ¤íŠ¸ë¦¼ ê¸°ë°˜ ì²˜ë¦¬ ì§€ì›

### í•µì‹¬ ê¸°ìˆ  ìš”ì†Œ
1. **Java I/O/NIO**: íš¨ìœ¨ì ì¸ íŒŒì¼ ì²˜ë¦¬
2. **equals/hashCode**: í•´ì‹œ ê¸°ë°˜ ì»¬ë ‰ì…˜ ì§€ì›
3. **Stream API**: í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë°ìœ¼ë¡œ ê°€ë…ì„± í–¥ìƒ
4. **ë°©ì–´ì  ë³µì‚¬**: ë°ì´í„° ë¬´ê²°ì„± ë³´ì¥
5. **@Deprecated**: í•˜ìœ„ í˜¸í™˜ì„±ê³¼ API ì§„í™”

ì´ êµ¬í˜„ì„ í†µí•´ Spring MVCì™€ ìœ ì‚¬í•œ ìˆ˜ì¤€ì˜ íŒŒì¼ ì—…ë¡œë“œ ê¸°ëŠ¥ì„ ì œê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤! ğŸ¯