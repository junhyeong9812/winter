# 25ì±•í„° ì„¸ì…˜ ê´€ë¦¬ êµ¬í˜„ ê³¼ì •

## ğŸ“– ê°œìš”
Winter Frameworkì— HTTP ì„¸ì…˜ ê´€ë¦¬ ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ëŠ” 25ì±•í„° êµ¬í˜„ ê³¼ì •ì„ ì •ë¦¬í•œ ë¬¸ì„œì…ë‹ˆë‹¤.

## ğŸ¯ êµ¬í˜„ ëª©í‘œ
- HTTP ì„¸ì…˜ ìƒì„± ë° ê´€ë¦¬
- ì¿ í‚¤ ê¸°ë°˜ ì„¸ì…˜ ID ê´€ë¦¬
- ì„¸ì…˜ ê¸°ë°˜ ìƒíƒœ ìœ ì§€ (ë¡œê·¸ì¸, ì‡¼í•‘ì¹´íŠ¸ ë“±)
- ì„¸ì…˜ ìƒëª…ì£¼ê¸° ê´€ë¦¬ (ìƒì„±, ê°±ì‹ , ë§Œë£Œ, ë¬´íš¨í™”)

## ğŸ”§ êµ¬í˜„ëœ ì£¼ìš” ì»´í¬ë„ŒíŠ¸

### 1. ì„¸ì…˜ ê´€ë¦¬ í•µì‹¬ í´ë˜ìŠ¤
- **`HttpSession`** - ì„¸ì…˜ ì¸í„°í˜ì´ìŠ¤
- **`StandardHttpSession`** - ì„¸ì…˜ êµ¬í˜„ì²´
- **`SessionManager`** - ì„¸ì…˜ ìƒëª…ì£¼ê¸° ì¤‘ì•™ ê´€ë¦¬
- **`SessionConfig`** - ì„¸ì…˜ ì„¤ì • ê´€ë¦¬
- **`Cookie`** - HTTP ì¿ í‚¤ ê´€ë¦¬

### 2. ê¸°ì¡´ í´ë˜ìŠ¤ í™•ì¥
- **`HttpRequest`** - ì„¸ì…˜ ì ‘ê·¼ ë©”ì„œë“œ ì¶”ê°€
- **`HttpResponse`** - ì¿ í‚¤ ì„¤ì • ê¸°ëŠ¥ ì¶”ê°€
- **`Dispatcher`** - ì„¸ì…˜ ìƒëª…ì£¼ê¸° í†µí•©

### 3. í…ŒìŠ¤íŠ¸ ì»´í¬ë„ŒíŠ¸
- **`SessionController`** - ì„¸ì…˜ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ìš© ì»¨íŠ¸ë¡¤ëŸ¬
- **`SessionHtmlGenerator`** - ê°„ë‹¨í•œ HTML ìƒì„± ìœ í‹¸ë¦¬í‹°

## ğŸ“ êµ¬í˜„ ë‹¨ê³„ë³„ ê³¼ì •

### Step 1: ì„¸ì…˜ ì¸í„°í˜ì´ìŠ¤ ë° êµ¬í˜„ì²´ ì‘ì„±
```java
// HttpSession ì¸í„°í˜ì´ìŠ¤ ì •ì˜
public interface HttpSession {
    String getId();
    Object getAttribute(String name);
    void setAttribute(String name, Object value);
    void invalidate();
    // ... ê¸°íƒ€ ë©”ì„œë“œë“¤
}

// StandardHttpSession êµ¬í˜„ì²´ ì‘ì„±
public class StandardHttpSession implements HttpSession {
    // ë©”ëª¨ë¦¬ ê¸°ë°˜ ì„¸ì…˜ êµ¬í˜„
    // ìƒì„±ì‹œê°„, ë§ˆì§€ë§‰ ì ‘ê·¼ì‹œê°„, íƒ€ì„ì•„ì›ƒ ê´€ë¦¬
}
```

### Step 2: ì„¸ì…˜ ë§¤ë‹ˆì € êµ¬í˜„
```java
public class SessionManager {
    // ì„¸ì…˜ ìƒì„±, ì¡°íšŒ, ì‚­ì œ
    // ë°±ê·¸ë¼ìš´ë“œ ì •ë¦¬ ì‘ì—…
    // í†µê³„ ì •ë³´ ê´€ë¦¬
}
```

### Step 3: ì¿ í‚¤ ê´€ë¦¬ ê¸°ëŠ¥ ì¶”ê°€
```java
public class Cookie {
    // RFC 6265 í‘œì¤€ ì¤€ìˆ˜
    // ë³´ì•ˆ ì„¤ì • (HttpOnly, Secure, SameSite)
    // HTTP í—¤ë” ë¬¸ìì—´ ìƒì„±
}
```

### Step 4: HTTP ìš”ì²­/ì‘ë‹µ í´ë˜ìŠ¤ í™•ì¥
```java
// HttpRequestì— ì„¸ì…˜ ê´€ë ¨ ë©”ì„œë“œ ì¶”ê°€
public HttpSession getSession();
public Cookie getCookie(String name);

// HttpResponseì— ì¿ í‚¤ ê´€ë ¨ ë©”ì„œë“œ ì¶”ê°€
public void addCookie(Cookie cookie);
public void setSessionCookie(String sessionId);
```

### Step 5: Dispatcher í†µí•©
```java
// ì„¸ì…˜ ìƒëª…ì£¼ê¸°ë¥¼ ìš”ì²­ ì²˜ë¦¬ ê³¼ì •ì— í†µí•©
private void handleSession(HttpRequest request, HttpResponse response) {
    // ì„¸ì…˜ ID ì¶”ì¶œ
    // ê¸°ì¡´ ì„¸ì…˜ ì¡°íšŒ ë˜ëŠ” ìƒˆ ì„¸ì…˜ ìƒì„±
    // ì„¸ì…˜ ì¿ í‚¤ ì„¤ì •
}
```

### Step 6: í…ŒìŠ¤íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ ì‘ì„±
```java
@Controller
public class SessionController {
    @RequestMapping("/session")
    public ModelAndView sessionHome(HttpRequest request);
    
    @RequestMapping("/session/login")
    public ModelAndView login(@RequestParam("username") String username);
    
    // ... ê¸°íƒ€ ì„¸ì…˜ í…ŒìŠ¤íŠ¸ ë©”ì„œë“œë“¤
}
```

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### 1. ê¸°ë³¸ ì„¸ì…˜ ê´€ë¦¬
- ìƒˆ ì„¸ì…˜ ìƒì„±
- ê¸°ì¡´ ì„¸ì…˜ ì¬ì‚¬ìš©
- ì„¸ì…˜ ì •ë³´ ì¡°íšŒ

### 2. ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ ì‹œë®¬ë ˆì´ì…˜
- ì‚¬ìš©ì ì¸ì¦ ë° ì„¸ì…˜ ì €ì¥
- ì„¸ì…˜ ê¸°ë°˜ ì‚¬ìš©ì ì •ë³´ ìœ ì§€
- ë¡œê·¸ì•„ì›ƒ ì‹œ ì„¸ì…˜ ë¬´íš¨í™”

### 3. ì‡¼í•‘ì¹´íŠ¸ ê¸°ëŠ¥
- ì„¸ì…˜ ê¸°ë°˜ ì¥ë°”êµ¬ë‹ˆ ê´€ë¦¬
- ìƒí’ˆ ì¶”ê°€/ì œê±°
- ì¥ë°”êµ¬ë‹ˆ ìƒíƒœ ìœ ì§€

### 4. ì„¸ì…˜ ì„¤ì • ê´€ë¦¬
- íƒ€ì„ì•„ì›ƒ ë³€ê²½
- ì„¸ì…˜ ì†ì„± CRUD

## ğŸ”‘ í•µì‹¬ íŠ¹ì§•

### ë³´ì•ˆ
- ë³´ì•ˆ ê°•í™”ëœ ì„¸ì…˜ ID ìƒì„± (128bit ì—”íŠ¸ë¡œí”¼)
- HttpOnly, Secure, SameSite ì¿ í‚¤ ì„¤ì •
- ì„¸ì…˜ ê³ ì • ê³µê²© ë°©ì§€

### ì„±ëŠ¥
- ë©”ëª¨ë¦¬ ê¸°ë°˜ ê³ ì† ì„¸ì…˜ ì €ì¥ì†Œ
- ë°±ê·¸ë¼ìš´ë“œ ë§Œë£Œ ì„¸ì…˜ ì •ë¦¬
- ConcurrentHashMapì„ í†µí•œ ë™ì‹œì„± ì§€ì›

### í™•ì¥ì„±
- ì¸í„°í˜ì´ìŠ¤ ê¸°ë°˜ ì„¤ê³„ë¡œ í™•ì¥ ê°€ëŠ¥
- ë¶„ì‚° ì„¸ì…˜ ìŠ¤í† ì–´ ì—°ë™ ê°€ëŠ¥
- ë‹¤ì–‘í•œ ì„¸ì…˜ ì €ì¥ ë°©ì‹ ì§€ì› ê°€ëŠ¥

## ğŸ“Š í†µê³„ ë° ëª¨ë‹ˆí„°ë§
- ìƒì„±ëœ ì„¸ì…˜ ìˆ˜
- ë§Œë£Œëœ ì„¸ì…˜ ìˆ˜
- ë¬´íš¨í™”ëœ ì„¸ì…˜ ìˆ˜
- í˜„ì¬ í™œì„± ì„¸ì…˜ ìˆ˜

## ğŸš€ ì‹¤í–‰ ë°©ë²•
```bash
# WinterMain ì‹¤í–‰
java winter.WinterMain

# ì„¸ì…˜ í…ŒìŠ¤íŠ¸ í™•ì¸
# ì½˜ì†”ì—ì„œ ì„¸ì…˜ ìƒì„±, ì†ì„± ì„¤ì •, ë¡œê·¸ì¸ ë“±ì˜ ê³¼ì • í™•ì¸
```

## ğŸ“ˆ í–¥í›„ í™•ì¥ ê³„íš
- Redis ì—°ë™ ë¶„ì‚° ì„¸ì…˜
- ì„¸ì…˜ í´ëŸ¬ìŠ¤í„°ë§
- ì„¸ì…˜ ì˜ì†í™”
- ì„¸ì…˜ ë³µì œ ë° ë°±ì—…
- ì›¹ UI ì„¸ì…˜ ëª¨ë‹ˆí„°ë§ ë„êµ¬

## ğŸ‰ ì™„ì„±ë„
âœ… ê¸°ë³¸ ì„¸ì…˜ ê´€ë¦¬  
âœ… ì¿ í‚¤ ê¸°ë°˜ ì„¸ì…˜ ID ê´€ë¦¬  
âœ… ì„¸ì…˜ ìƒëª…ì£¼ê¸° ê´€ë¦¬  
âœ… ë³´ì•ˆ ì„¤ì •  
âœ… í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤  
âœ… í†µê³„ ë° ëª¨ë‹ˆí„°ë§

25ì±•í„° ì„¸ì…˜ ê´€ë¦¬ ê¸°ëŠ¥ì´ ì„±ê³µì ìœ¼ë¡œ êµ¬í˜„ë˜ì—ˆìŠµë‹ˆë‹¤!

# 25ì±•í„° ì„¸ì…˜ êµ¬í˜„ ì¤‘ ë°œìƒí•œ ë¬¸ì œë“¤ê³¼ í•´ê²° ë°©ë²•

## ğŸš¨ ë¬¸ì œ í•´ê²° ê°€ì´ë“œ

### ë¬¸ì œ 1: Cookie í´ë˜ìŠ¤ì— `toHeaderString()` ë©”ì„œë“œ ëˆ„ë½
**ì¦ìƒ:**
```
java.lang.NoSuchMethodError: winter.http.Cookie.toHeaderString()
```

**ì›ì¸:**
- HttpResponseì—ì„œ `cookie.toHeaderString()` í˜¸ì¶œí•˜ëŠ”ë° ë©”ì„œë“œê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŒ
- Cookie í´ë˜ìŠ¤ê°€ HTTP Set-Cookie í—¤ë” ìƒì„± ê¸°ëŠ¥ ëˆ„ë½

**í•´ê²° ë°©ë²•:**
```java
// Cookie.javaì— ì¶”ê°€
public String toHeaderString() {
    StringBuilder header = new StringBuilder();
    header.append(name).append("=").append(value != null ? value : "");
    
    if (path != null) {
        header.append("; Path=").append(path);
    }
    if (domain != null) {
        header.append("; Domain=").append(domain);
    }
    if (maxAge >= 0) {
        header.append("; Max-Age=").append(maxAge);
    }
    if (httpOnly) {
        header.append("; HttpOnly");
    }
    if (secure) {
        header.append("; Secure");
    }
    if (sameSite != null) {
        header.append("; SameSite=").append(sameSite);
    }
    
    return header.toString();
}
```

---

### ë¬¸ì œ 2: @RequestMapping ì–´ë…¸í…Œì´ì…˜ ì†ì„± ë¶ˆì¼ì¹˜
**ì¦ìƒ:**
- SessionControllerì—ì„œ `path` ì†ì„± ì‚¬ìš©í–ˆìœ¼ë‚˜ í‘œì¤€ì€ `value` ì†ì„±

**ì›ì¸:**
- Spring í‘œì¤€ì—ì„œëŠ” `value` ì†ì„±ì´ ê¸°ë³¸
- ê¸°ì¡´ í”„ë¡œì íŠ¸ì™€ ì¼ê´€ì„± ë¶€ì¡±

**í•´ê²° ë°©ë²•:**
```java
// Before
@RequestMapping(path = "/session", method = "GET")

// After  
@RequestMapping(value = "/session", method = "GET")
```

---

### ë¬¸ì œ 3: ModelAndView ìƒì„±ì ì‚¬ìš© ì˜¤ë¥˜
**ì¦ìƒ:**
```
java.lang.NoSuchMethodException: ModelAndView.<init>(String, Map)
```

**ì›ì¸:**
- ModelAndViewëŠ” ë·° ì´ë¦„ë§Œ ë°›ëŠ” ìƒì„±ìë§Œ ì¡´ì¬
- ëª¨ë¸ ë°ì´í„°ëŠ” `addAttribute()` ë©”ì„œë“œë¡œ ì¶”ê°€í•´ì•¼ í•¨

**í•´ê²° ë°©ë²•:**
```java
// Before (ì˜ëª»ëœ ë°©ì‹)
Map<String, Object> model = new HashMap<>();
model.put("key", "value");
return new ModelAndView("viewName", model);

// After (ì˜¬ë°”ë¥¸ ë°©ì‹)
ModelAndView mv = new ModelAndView("viewName");
mv.addAttribute("key", "value");
return mv;
```

---

### ë¬¸ì œ 4: SessionControllerê°€ HandlerMappingì— ë“±ë¡ë˜ì§€ ì•ŠìŒ
**ì¦ìƒ:**
```
Failed to invoke handler method: HandlerMethod{path='/session/set', method='POST', handler=SessionController.setSessionAttribute()}
```

**ì›ì¸:**
- CombinedHandlerMappingì˜ `registerAllControllers()` ë©”ì„œë“œì— SessionController ë“±ë¡ ëˆ„ë½
- ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ë“±ë¡ë˜ì§€ ì•Šì•„ HandlerMethodë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ

**í•´ê²° ë°©ë²•:**
```java
// CombinedHandlerMapping.javaì˜ registerAllControllers() ë©”ì„œë“œì— ì¶”ê°€
private void registerAllControllers() {
    try {
        annotationHandlerMapping.registerController(ProductController.class);
        annotationHandlerMapping.registerController(SearchController.class);
        annotationHandlerMapping.registerController(FileUploadController.class);
        
        // 25ë‹¨ê³„: ì„¸ì…˜ ê´€ë¦¬ í…ŒìŠ¤íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ ë“±ë¡
        annotationHandlerMapping.registerController(SessionController.class);
        
    } catch (Exception e) {
        System.err.println("Failed to register annotation controllers: " + e.getMessage());
    }
}
```

---

### ë¬¸ì œ 5: @RequestParam íŒŒë¼ë¯¸í„° ë°”ì¸ë”© ì‹¤íŒ¨
**ì¦ìƒ:**
```
Failed to invoke handler method: HandlerMethod{...}
```

**ì›ì¸:**
- `@RequestParam(name = "paramName")` ì‚¬ìš© ì‹œ íŒŒë¼ë¯¸í„° ë§¤í•‘ ì‹¤íŒ¨
- ParameterResolverì—ì„œ `value()` ìš°ì„  í™•ì¸ í›„ `name()` í™•ì¸í•˜ëŠ”ë°, `value()`ê°€ ë¹ˆ ë¬¸ìì—´ì´ë©´ ë§¤í•‘ ì‹¤íŒ¨

**í•´ê²° ë°©ë²•:**
```java
// Before (ë¬¸ì œ ìˆëŠ” ì½”ë“œ)
@RequestParam(name = "key") String key
@RequestParam(name = "value") String value

// After (ìˆ˜ì •ëœ ì½”ë“œ)
@RequestParam("key") String key
@RequestParam("value") String value
```

---

### ë¬¸ì œ 6: SessionManager shutdown ì‹œ ì¤‘ë³µ ë¬´íš¨í™” ì˜¤ë¥˜
**ì¦ìƒ:**
```
java.lang.IllegalStateException: Session has been invalidated
```

**ì›ì¸:**
- `invalidateAllSessions()`ì—ì„œ ì´ë¯¸ ë¬´íš¨í™”ëœ ì„¸ì…˜ì„ ë‹¤ì‹œ ë¬´íš¨í™”í•˜ë ¤ê³  ì‹œë„
- ì„¸ì…˜ ë¬´íš¨í™” í›„ ë‹¤ì‹œ `invalidate()` í˜¸ì¶œ ì‹œ ì˜ˆì™¸ ë°œìƒ

**í•´ê²° ë°©ë²•:**
```java
public void invalidateAllSessions() {
    int invalidatedCount = 0;
    for (Map.Entry<String, StandardHttpSession> entry : sessions.entrySet()) {
        StandardHttpSession session = entry.getValue();
        if (session.isValid()) {
            try {
                session.invalidate();
                invalidatedCount++;
            } catch (IllegalStateException e) {
                // ì´ë¯¸ ë¬´íš¨í™”ëœ ì„¸ì…˜ì€ ë¬´ì‹œ
            }
        }
    }
    totalSessionsInvalidated += invalidatedCount;
    sessions.clear();
}
```

---

## ğŸ” ë””ë²„ê¹… íŒ

### 1. í•¸ë“¤ëŸ¬ ë“±ë¡ í™•ì¸
```java
// CombinedHandlerMappingì—ì„œ ë“±ë¡ëœ í•¸ë“¤ëŸ¬ ì¶œë ¥
public void printRegisteredHandlers() {
    System.out.println("=== Registered Handlers ===");
    for (HandlerMethod handler : annotationHandlerMapping.getAllHandlers()) {
        System.out.println("  " + handler);
    }
}
```

### 2. íŒŒë¼ë¯¸í„° ë°”ì¸ë”© ë””ë²„ê¹…
```java
// ParameterResolverì—ì„œ ë””ë²„ê¹… ì •ë³´ ì¶œë ¥
System.out.println("=== Parameter Binding Debug Info ===");
System.out.println("Method: " + method.getName() + " with " + parameters.length + " parameters");
for(int i = 0; i < parameters.length; i++){
    Parameter parameter = parameters[i];
    String strategy = parameterResolver.getResolutionStrategy(parameter);
    System.out.println("Parameter " + i + " (" + parameter.getType().getSimpleName() + "): " + strategy);
}
```

### 3. ì„¸ì…˜ ìƒíƒœ ëª¨ë‹ˆí„°ë§
```java
// SessionManager ìƒíƒœ ì •ë³´ ì¶œë ¥
System.out.println("SessionManager ìƒíƒœ: " + sessionManager.toString());
```

## âš ï¸ ì£¼ì˜ì‚¬í•­

1. **ì–´ë…¸í…Œì´ì…˜ ì†ì„± ì¼ê´€ì„±**: `@RequestMapping`ê³¼ `@RequestParam`ì—ì„œ `value` ì†ì„± ì‚¬ìš© ê¶Œì¥
2. **ModelAndView ì‚¬ìš©ë²•**: ìƒì„±ìëŠ” ë·° ì´ë¦„ë§Œ, ëª¨ë¸ì€ `addAttribute()` ì‚¬ìš©
3. **ì»¨íŠ¸ë¡¤ëŸ¬ ë“±ë¡**: ìƒˆë¡œìš´ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” CombinedHandlerMappingì— ë“±ë¡ í•„ìš”
4. **ì„¸ì…˜ ë¬´íš¨í™”**: ì´ë¯¸ ë¬´íš¨í™”ëœ ì„¸ì…˜ì— ëŒ€í•œ ì¤‘ë³µ ì²˜ë¦¬ ë°©ì§€
5. **ì¿ í‚¤ í—¤ë”**: HTTP í‘œì¤€ì— ë§ëŠ” Set-Cookie í—¤ë” ë¬¸ìì—´ ìƒì„±

## ğŸ¯ ì˜ˆë°© ë°©ë²•

1. **ì½”ë“œ ë¦¬ë·°**: ì–´ë…¸í…Œì´ì…˜ ì‚¬ìš©ë²•ê³¼ API í˜¸ì¶œ ë°©ì‹ ê²€í† 
2. **ë‹¨ìœ„ í…ŒìŠ¤íŠ¸**: ê° ì»´í¬ë„ŒíŠ¸ë³„ ë…ë¦½ì ì¸ í…ŒìŠ¤íŠ¸ ì‘ì„±
3. **í†µí•© í…ŒìŠ¤íŠ¸**: ì „ì²´ ìš”ì²­-ì‘ë‹µ íë¦„ í…ŒìŠ¤íŠ¸
4. **ë¡œê¹… ê°•í™”**: ë””ë²„ê¹… ì •ë³´ ì¶©ë¶„íˆ ì¶œë ¥
5. **ë¬¸ì„œí™”**: API ì‚¬ìš©ë²•ê³¼ ì£¼ì˜ì‚¬í•­ ë¬¸ì„œí™”

ì´ëŸ¬í•œ ë¬¸ì œë“¤ì„ í†µí•´ Winter Frameworkì˜ ì„¸ì…˜ ê´€ë¦¬ ê¸°ëŠ¥ì´ ë”ìš± ê²¬ê³ í•´ì¡ŒìŠµë‹ˆë‹¤!